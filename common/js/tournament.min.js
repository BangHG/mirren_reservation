function startTournament(){function n(){tournamentContainer.innerHTML="",tournamentResultContainer.style.display="none",t(e);const n=document.querySelector(".tournament-container .gauge");n&&(n.style.width="0%")}function t(e){function a(){i.length===e.length/2&&(1===i.length?setTimeout(()=>{fadeOutElement(tournamentContainer,()=>{function t(){return Math.floor(5*Math.random())+1}const e=i[0];localStorage.setItem("tournamentWinner",JSON.stringify(e));const a=resultWrap.querySelector(".img"),o=resultWrap.querySelector(".btn-saveImg");a.setAttribute("data-index",t()),a.style.backgroundImage=`url(${$rootUrl}/common/images/tournament/${e.id}.webp)`,a.textContent=`${e.name}`,o.href=`${$rootUrl}/common/images/tournament/${e.id}.jpg`,o.download=`${e.name}.jpg`,$(document).on("click",".tournament-result-wrap .btn-saveImg",function(){const n=`${$rootUrl}/common/images/tournament/${e.id}.jpg`,t=`${e.name}.jpg`;fetch(n).then(n=>n.blob()).then(n=>{const e=document.createElement("a");e.href=URL.createObjectURL(n),e.download=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}).catch(n=>console.error("Error downloading the image:",n))}),fadeInElement(tournamentResultContainer,300),setTimeout(()=>{$(".tournament-result-wrap").addClass("initAni")},300);const s=document.getElementById("btn-restart");s.addEventListener("click",()=>{fadeOutElement(tournamentResultContainer,()=>{n(),$(".tournament-result-wrap").removeClass("initAni"),fadeInElement(tournamentContainer)})})})},100):setTimeout(()=>{fadeOutElement(tournamentContainer,()=>{t(i),fadeInElement(tournamentContainer)})},100))}function o(n,t,e){const o=document.createElement("div");o.className="match",o.style.opacity="0";const i=`\n        <button class="item-button">\n          <div class="img" style="background-image:url(${$rootUrl}/common/images/tournament/${n.id}.webp)">${n.name}</div>\n        </button>`,r=`\n        <button class="item-button">\n          <div class="img" style="background-image:url(${$rootUrl}/common/images/tournament/${t.id}.webp)">${t.name}</div>\n        </button>`,m=createElementFromHTML(i),d=createElementFromHTML(r);return m.addEventListener("click",()=>{o.classList.contains("done")||(o.classList.add("done"),d.disabled=!0,m.classList.add("selected"),e.push(n),a(),fadeOutMatch(o),s())}),d.addEventListener("click",()=>{o.classList.contains("done")||(o.classList.add("done"),m.disabled=!0,d.classList.add("selected"),e.push(t),a(),fadeOutMatch(o),s())}),o.appendChild(m),o.appendChild(createElementFromHTML('<span class="vs"><span class="sr-only">VS</span></span>')),o.appendChild(d),o}function s(){const n=document.querySelector(".tournament-container .gauge");m+=1;const t=m/d*100;n.style.width=`${t}%`}e=shuffleArray(e),2===e.length?tournamentContainer.innerHTML=`\n      <span class="sr-only">마음에 드는 성흔을 선택해주세요!</span>\n      <p class="match-round match-round--${e.length}">\n      <span class="sr-only">결승</span>\n      </p>\n      `:tournamentContainer.innerHTML=`\n      <span class="sr-only">마음에 드는 성흔을 선택해주세요!</span>\n      <p class="match-round match-round--${e.length}">\n      <span class="sr-only">${e.length}강</span>\n      </p>\n      <div class="gauge-wrap"><span class="gauge"></span></span></div>\n      `;let i=[];const r=document.createElement("div");r.className="match-container";for(let n=0;n<e.length;n+=2){const t=o(e[n],e[n+1],i);r.appendChild(t),n===e.length-2&&(t.style.opacity="1")}tournamentContainer.appendChild(r);let m=0;const d=e.length/2}const e=[{id:"1",name:"일라"},{id:"2",name:"앰프사"},{id:"3",name:"대니"},{id:"4",name:"시슬리"},{id:"5",name:"사라"},{id:"6",name:"마키"},{id:"7",name:"제랄디아"},{id:"8",name:"크리슈나"},{id:"9",name:"이카루스"},{id:"10",name:"아넥스"},{id:"11",name:"디아"},{id:"12",name:"나르키소스"},{id:"13",name:"아이카"},{id:"14",name:"쿠로신"},{id:"15",name:"플림턴"},{id:"16",name:"야요이"},{id:"17",name:"애슐"},{id:"18",name:"아포피스"},{id:"19",name:"나피"},{id:"20",name:"쿠로아이"},{id:"21",name:"베라"},{id:"22",name:"캐롤린"},{id:"23",name:"로잘리"},{id:"24",name:"처칠"},{id:"25",name:"나나브"},{id:"26",name:"에어린"},{id:"27",name:"베르다"},{id:"28",name:"라일라"},{id:"29",name:"플로라"},{id:"30",name:"도로시"},{id:"31",name:"호무라"},{id:"32",name:"시아"}];n()}function createElementFromHTML(n){const t=document.createElement("div");return t.innerHTML=n.trim(),t.firstChild}function shuffleArray(n){for(let t=n.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[n[t],n[e]]=[n[e],n[t]]}return n}function fadeOutElement(n,t){n.style.transition="opacity 0.3s",n.style.opacity="0",setTimeout(()=>{n.style.display="none",t&&t()},300)}function fadeInElement(n,t=100){n.style.opacity="0",n.style.display="block",setTimeout(()=>{n.style.transition="opacity 0.3s",n.style.opacity="1"},t)}function fadeOutMatch(n){setTimeout(()=>{n.style.transition="opacity 0.3s",n.style.opacity="0";const t=n.previousElementSibling;t&&t.classList.contains("match")&&(t.style.opacity="1"),setTimeout(()=>{n.remove()},200)},300)}function tournamentEnd(){$(".dimmed").fadeOut(),$(".tournament-container").fadeOut(),$(".tournament-result-wrap").removeClass("initAni")}function tournamentStart(n){startTournament(),$(".dimmed").fadeIn(),$(".tournament-container").fadeIn(),fadeInElement(tournamentContainer);const t=$(".tournament-container"),e=t.offset().top,a=t.outerHeight(),o=$(window).height(),s=e-o/2+a/2;"mo"==n?$("body,html").animate({scrollTop:$(".event-content--4").offset().top},300):$("body,html").animate({scrollTop:s},300)}document.addEventListener("DOMContentLoaded",()=>{startTournament()});const tournamentContainer=document.getElementById("tournament"),tournamentResultContainer=document.getElementById("tournament-result"),resultWrap=document.querySelector("#tournament-result .tournament-result-wrap");